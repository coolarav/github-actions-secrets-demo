name: Lab 4 - Secret Usage Patterns

on:
  workflow_dispatch:    # manual run from Actions tab

jobs:
  demo-secret-usage:
    runs-on: ubuntu-latest

    # Pattern 2: Job-wide secret via env
    env:
      JOB_LEVEL_SECRET: ${{ secrets.MY_SECRET }}

    steps:
      # Pattern 1: Inline secret env for a single step
      - name: Step 1 - Inline secret for this step only
        run: echo "Inline secret is:$INLINE_SECRET"
        env:
          INLINE_SECRET: ${{ secrets.MY_SECRET }}

      # Pattern 2: Job-wide env secret (already defined above)
      - name: Step 2 - Use job-wide secret
        run: echo "Job-level secret is:$JOB_LEVEL_SECRET"

      # Pattern 3: Pass secret into an action via env
      - name: Step 3 - Pass secret to an action (github-script)
        uses: actions/github-script@v7
        env:
          SCRIPT_SECRET: ${{ secrets.MY_SECRET }}
        with:
          script: |
            // We don't print the secret, only its length
            const len = process.env.SCRIPT_SECRET ? process.env.SCRIPT_SECRET.length : 0;
            core.info(`Script received a secret of length ${len}`);
